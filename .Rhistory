library(lubridate)
library(data.table)
library(tidyr)
library(ggplot2)
meds <- data.table(read.csv("cost_medians_table.csv"))
meds
cast (meds)
spread(meds)
spread(meds, median.cost)
meds
?spread
spread(meds, source, median.cost)
user <- data.table(read.csv("DB/table_user.csv.bz2"))
log <- data.table(read.csv("DB/table_log.csv.bz2"))
median(log[region=="ekb" && source="cpc_adwords"]) 
median(log[region=="ekb" && source=="cpc_adwords"], cost) 
median(user[region=="ekb" && source=="cpc_adwords"], cost) 
median(user[region=="ekb" && source=="cpc_adwords"], cost) 
head(user)
median(user[region=="ekb" & source=="cpc_adwords"], cost) 
median(user[region=="ekb" & source=="cpc_adwords", cost]) 
median(user[region=="moscow" & source=="cpc_adwords", cost]) 
median(user[region=="orel" & source=="cpc_adwords", cost]) 
median(user[region=="spb" & source=="cpc_adwords", cost]) 
median(user[region=="vladimir" & source=="cpc_adwords", cost]) 
median(user[region=="volgograd" & source=="cpc_adwords", cost]) 
median(user[region=="ekb" & source=="cpc_direct", cost]) 
median(user[region=="moscow" & source=="cpc_direct", cost]) 
median(user[region=="orel" & source=="cpc_direct", cost]) 
median(user[region=="vladimir" & source=="cpc_direct", cost]) 
median(user[region=="volgograd" & source=="cpc_direct", cost]) 
median(user[region=="ekb" & source=="seo", cost]) 
median(user[region=="moscow" & source=="seo", cost]) 
median(user[region=="orel" & source=="seo", cost]) 
median(user[region=="spb" & source=="seo", cost]) 
median(user[region=="vladimir" & source=="seo", cost]) 
median(user[region=="volgograd" & source=="seo", cost]) 
median(user[region=="volgograd" & source=="smm", cost]) 
median(user[region=="vladimir" & source=="smm", cost]) 
median(user[region=="spb" & source=="smm", cost]) 
median(user[region=="orel" & source=="smm", cost]) 
median(user[region=="moscow" & source=="smm", cost]) 
median(user[region=="ekb" & source=="smm", cost]) 
